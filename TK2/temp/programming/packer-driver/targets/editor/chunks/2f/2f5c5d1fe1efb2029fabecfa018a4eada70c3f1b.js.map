{"version":3,"sources":["file:///C:/Users/53190/Desktop/TK2/assets/text/enemytank-002/enemyfire.ts"],"names":["_decorator","Component","Prefab","RigidBody2D","instantiate","Vec2","enemytank_002","ccclass","property","enemyfire","lastFireTime","landminelastFireTime","speed","lastdirection","update","dt","fireInterval","fireBullet","landminefireInterval","putlandmine","bullet","bulletPrefab","setParent","node","setPosition","position","tank","parent","getComponent","rgd","currentspeed","x","shootPower","y","clone","linearVelocity","onKeyDown0","event","now","Date","landminePrefab"],"mappings":"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","sourcesContent":["import { _decorator, Component, Prefab, systemEvent, Input, input, EventMouse, SystemEvent, Node, EventKeyboard, macro, RigidBody2D, Vec3, instantiate } from 'cc';\r\nimport { Vec2 } from 'cc';\r\nimport { enemytank_002 } from './enemytank-002';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('enemyfire')\r\nexport class enemyfire extends Component {\r\n\r\n    @property\r\n    shootPower: number = 300;//子弹的发射速度\r\n\r\n    lastFireTime: number = 0; // 上次发射时间\r\n    @property\r\n    fireInterval: number = 1; // 发射间隔时间，单位秒\r\n\r\n    landminelastFireTime: number = 0; // 上次发射时间\r\n    @property\r\n    landminefireInterval: number = 2; // 发射间隔时间，单位秒\r\n\r\n    @property(Prefab)\r\n    bulletPrefab: Prefab = null;\r\n\r\n    @property(Prefab)\r\n    landminePrefab: Prefab = null;\r\n\r\n  \r\n\r\n    //子弹的速度\r\n    speed: Vec2 = new Vec2(0, 0);\r\n    lastdirection: Vec2 = new Vec2(0, 0)\r\n\r\n\r\n    update(dt) {\r\n        this.lastFireTime += dt;\r\n        this.landminelastFireTime += dt;\r\n        // 如果达到了子弹发射间隔\r\n        if (this.lastFireTime >= this.fireInterval) {\r\n            this.fireBullet();\r\n            this.lastFireTime = 0;\r\n        }\r\n\r\n        // 如果达到了地雷发射间隔\r\n        if (this.landminelastFireTime >= this.landminefireInterval) {\r\n\r\n            this.putlandmine();\r\n            this.landminelastFireTime = 0;\r\n        }\r\n    }\r\n\r\n    private fireBullet() {\r\n        const bullet = instantiate(this.bulletPrefab);\r\n        bullet.setParent(this.node);\r\n        bullet.setPosition(this.node.position);\r\n\r\n        //设置子弹实例的具体属性\r\n        const tank = this.node.parent.getComponent(enemytank_002);\r\n        const rgd = bullet.getComponent(RigidBody2D);\r\n        this.speed = new Vec2(tank.currentspeed.x * this.shootPower, tank.currentspeed.y * this.shootPower);\r\n        if (this.speed.x !== 0 || this.speed.y !== 0) {\r\n            this.lastdirection = this.speed;\r\n        }\r\n        if (this.speed.x === 0 && this.speed.y === 0) {\r\n            this.speed = this.lastdirection.clone();\r\n        }\r\n        rgd.linearVelocity = this.speed;\r\n    }\r\n\r\n    //地雷放置模块\r\n\r\n    private onKeyDown0(event: EventKeyboard) {\r\n        const now = Date.now();\r\n        if (now - this.landminelastFireTime > this.landminefireInterval * 1000) {\r\n            this.putlandmine();\r\n            this.landminelastFireTime = now;\r\n        }\r\n    }\r\n\r\n    private putlandmine() {\r\n        const bullet = instantiate(this.landminePrefab);\r\n        bullet.setParent(this.node);\r\n        bullet.setPosition(this.node.position);\r\n\r\n        //设置子弹实例的具体属性\r\n    }\r\n}\r\n\r\n"]}