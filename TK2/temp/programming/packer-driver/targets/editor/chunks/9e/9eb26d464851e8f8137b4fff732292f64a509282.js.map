{"version":3,"sources":["file:///D:/TankFight/TK2/assets/Scripts/initlog.ts"],"names":["user","_decorator","Button","Component","director","EditBox","sys","native","ccclass","property","fileUtils","Account","Password","save","initlog","save_path","start","node","on","EventType","CLICK","checkAccount","setWritablePath","isDirectoryExist","createDirectory","update","deltaTime","_account","account","string","_pwd","password","length","_path","result","isFileExist","_user","json","JSON","stringify","localStorage","setItem","loadScene","_user2","parse","getItem"],"mappings":";;;iIAKMA,I;;;;;;;;;;;;;AALGC,MAAAA,U,OAAAA,U;AAAYC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,Q,OAAAA,Q;AAAUC,MAAAA,O,OAAAA,O;AAAqBC,MAAAA,G,OAAAA,G;AAE9DC,MAAAA,M,OAAAA,M;;;;;;;;;OADH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U;;;;OAExB;AAAES,QAAAA;AAAF,O,GAAgBH,M;AAEhBP,MAAAA,I,GAAN,MAAMA,IAAN,CAAU;AAAA;AAAA,eACNW,OADM;AAAA,eAENC,QAFM;AAAA,eAGNC,IAHM;AAAA;;AAAA,O;;yBAQGC,O,WAHZN,OAAO,CAAC,SAAD,C,UAIHC,QAAQ,CAACJ,OAAD,C,UAERI,QAAQ,CAACJ,OAAD,C,4BANb,MAGaS,OAHb,SAG6BX,SAH7B,CAGuC;AAAA;AAAA;;AAAA;;AAAA;;AAAA,eAMnCY,SANmC;AAAA;;AAOnCC,QAAAA,KAAK,GAAG;AACJ,eAAKC,IAAL,CAAUC,EAAV,CAAahB,MAAM,CAACiB,SAAP,CAAiBC,KAA9B,EAAqC,KAAKC,YAA1C,EAAwD,IAAxD;AACAX,UAAAA,SAAS,CAACY,eAAV,CAA0B,KAAKP,SAA/B;;AACA,cAAG,CAACL,SAAS,CAACa,gBAAV,CAA2B,KAAKR,SAAhC,CAAJ,EAAgD;AAC5CL,YAAAA,SAAS,CAACc,eAAV,CAA0B,KAAKT,SAA/B;AACH;AACJ;;AACDU,QAAAA,MAAM,CAACC,SAAD,EAAoB,CACzB;;AACDL,QAAAA,YAAY,GAAE;AACV,cAAIM,QAAQ,GAAC,KAAKC,OAAL,CAAaC,MAA1B;AACA,cAAIC,IAAI,GAAC,KAAKC,QAAL,CAAcF,MAAvB,CAFU,CAEoB;;AAC9B,cAAGF,QAAQ,CAACK,MAAT,IAAiB,CAAjB,IAAoBF,IAAI,CAACE,MAAL,IAAa,CAApC,EACI;;AACJ,cAAIC,KAAK,GAAC,KAAKlB,SAAL,GAAe,GAAf,GAAmBY,QAAnB,GAA4B,OAAtC;;AACA,cAAIO,MAAc,GAACxB,SAAS,CAACyB,WAAV,CAAsBF,KAAtB,CAAnB,CANU,CAMsC;;AAChD,cAAG,CAACC,MAAJ,EACA;AACI,gBAAIE,KAAK,GAAG;AACRzB,cAAAA,OAAO,EAAEgB,QADD;AAERf,cAAAA,QAAQ,EAAEkB,IAFF;AAGRjB,cAAAA,IAAI,EAAE;AAHE,aAAZ;AAKA,gBAAIwB,IAAI,GAACC,IAAI,CAACC,SAAL,CAAeH,KAAf,CAAT;AACA9B,YAAAA,GAAG,CAACkC,YAAJ,CAAiBC,OAAjB,CAAyBd,QAAzB,EAAmCW,IAAI,CAACC,SAAL,CAAeH,KAAf,CAAnC,EAPJ,CAO8D;;AAC1DhC,YAAAA,QAAQ,CAACsC,SAAT,CAAmB,QAAnB;AACH,WAVD,MAYA;AACI,gBAAIC,MAAM,GAACL,IAAI,CAACM,KAAL,CAAWtC,GAAG,CAACkC,YAAJ,CAAiBK,OAAjB,CAAyB,UAAzB,CAAX,CAAX;;AACA,gBAAGF,MAAM,CAAC/B,QAAP,IAAiBkB,IAApB,EACA;AAAC;AAAE,aADH,MAGA;AACI1B,cAAAA,QAAQ,CAACsC,SAAT,CAAmB,QAAnB;AACH,aAPL,CAOK;;AACA;AACJ;;AA5C8B,O","sourcesContent":["import { _decorator, Button, Component, director, EditBox, Node, path, sys, System } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\nimport { native } from \"cc\"; \r\nconst { fileUtils } = native;\r\n\r\nclass user{\r\n    Account:string;\r\n    Password:string;\r\n    save:number;\r\n}\r\n@ccclass('initlog')\r\n\r\n\r\nexport class initlog extends Component {\r\n    @property(EditBox)\r\n    account:EditBox;\r\n    @property(EditBox)\r\n    password:EditBox;\r\n\r\n    save_path:string;\r\n    start() {\r\n        this.node.on(Button.EventType.CLICK, this.checkAccount, this);\r\n        fileUtils.setWritablePath(this.save_path);\r\n        if(!fileUtils.isDirectoryExist(this.save_path)) {\r\n            fileUtils.createDirectory(this.save_path);\r\n        }\r\n    }\r\n    update(deltaTime: number) {\r\n    }\r\n    checkAccount(){\r\n        let _account=this.account.string;\r\n        let _pwd=this.password.string;//获取输入的用户和密码\r\n        if(_account.length==0||_pwd.length==0)\r\n            return;\r\n        let _path=this.save_path+\"/\"+_account+\".json\";\r\n        let result:Boolean=fileUtils.isFileExist(_path);//检测是否存在账户\r\n        if(!result)\r\n        {\r\n            let _user = {\r\n                Account: _account,\r\n                Password: _pwd,\r\n                save: 0,\r\n            };\r\n            let json=JSON.stringify(_user);\r\n            sys.localStorage.setItem(_account, JSON.stringify(_user));//不存在则创建新账户\r\n            director.loadScene('select');\r\n        }\r\n        else\r\n        {\r\n            let _user2=JSON.parse(sys.localStorage.getItem('_account'));\r\n            if(_user2.Password!=_pwd)\r\n            {;}\r\n            else\r\n            {\r\n                director.loadScene('select');\r\n            }//找到账户，检查密码\r\n            }\r\n        }\r\n}\r\n\r\n"]}