{"version":3,"sources":["file:///D:/TankFight/TK2/assets/text/enemytank-002/enemyfire.ts"],"names":["_decorator","Component","Prefab","RigidBody2D","instantiate","Vec2","enemytank_002","ccclass","property","enemyfire","lastFireTime","fireInterval","landminelastFireTime","landminefireInterval","speed","lastdirection","update","dt","fireBullet","putlandmine","bullet","bulletPrefab","setParent","node","setPosition","position","tank","parent","getComponent","rgd","currentspeed","x","shootPower","y","clone","linearVelocity","onKeyDown0","event","now","Date","landminePrefab"],"mappings":"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","sourcesContent":["import { _decorator, Component, Prefab, systemEvent, Input, input, EventMouse, SystemEvent, Node, EventKeyboard, macro, RigidBody2D, Vec3, instantiate } from 'cc';\r\nimport { Vec2 } from 'cc';\r\nimport { enemytank_002 } from './enemytank-002';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('enemyfire')\r\nexport class enemyfire extends Component {\r\n\r\n    @property\r\n    shootPower: number = 300;//子弹的发射速度\r\n\r\n    @property(Prefab)\r\n    bulletPrefab: Prefab = null;\r\n\r\n    @property(Prefab)\r\n    landminePrefab: Prefab = null;\r\n\r\n    lastFireTime: number = 0; // 上次发射时间\r\n    fireInterval: number = 1; // 发射间隔时间，单位秒\r\n\r\n    landminelastFireTime: number = 0; // 上次发射时间\r\n    landminefireInterval: number = 2; // 发射间隔时间，单位秒\r\n\r\n    //子弹的速度\r\n    speed: Vec2 = new Vec2(0, 0);\r\n    lastdirection: Vec2 = new Vec2(0, 0)\r\n\r\n\r\n    update(dt) {\r\n        this.lastFireTime += dt;\r\n        this.landminelastFireTime += dt;\r\n        // 如果达到了子弹发射间隔\r\n        if (this.lastFireTime >= this.fireInterval) {\r\n            this.fireBullet();\r\n            this.lastFireTime = 0;\r\n        }\r\n\r\n        // 如果达到了地雷发射间隔\r\n        if (this.landminelastFireTime >= this.landminefireInterval) {\r\n\r\n            this.putlandmine();\r\n            this.landminelastFireTime = 0;\r\n        }\r\n    }\r\n\r\n    private fireBullet() {\r\n        const bullet = instantiate(this.bulletPrefab);\r\n        bullet.setParent(this.node);\r\n        bullet.setPosition(this.node.position);\r\n\r\n        //设置子弹实例的具体属性\r\n        const tank = this.node.parent.getComponent(enemytank_002);\r\n        const rgd = bullet.getComponent(RigidBody2D);\r\n        this.speed = new Vec2(tank.currentspeed.x * this.shootPower, tank.currentspeed.y * this.shootPower);\r\n        if (this.speed.x !== 0 || this.speed.y !== 0) {\r\n            this.lastdirection = this.speed;\r\n        }\r\n        if (this.speed.x === 0 && this.speed.y === 0) {\r\n            this.speed = this.lastdirection.clone();\r\n        }\r\n        rgd.linearVelocity = this.speed;\r\n    }\r\n\r\n    //地雷放置模块\r\n\r\n    private onKeyDown0(event: EventKeyboard) {\r\n        const now = Date.now();\r\n        if (now - this.landminelastFireTime > this.landminefireInterval * 1000) {\r\n            this.putlandmine();\r\n            this.landminelastFireTime = now;\r\n        }\r\n    }\r\n\r\n    private putlandmine() {\r\n        const bullet = instantiate(this.landminePrefab);\r\n        bullet.setParent(this.node);\r\n        bullet.setPosition(this.node.position);\r\n\r\n        //设置子弹实例的具体属性\r\n    }\r\n}\r\n\r\n"]}