{"version":3,"sources":["file:///D:/TankFight/TK2/assets/text/enemytank/enemyfire.ts"],"names":["_decorator","Component","Prefab","RigidBody2D","instantiate","Vec2","enemytank","ccclass","property","enemyfire","lastFireTime","fireInterval","landminelastFireTime","landminefireInterval","speed","lastdirection","update","dt","console","log","fireBullet","putlandmine","bullet","bulletPrefab","setParent","node","setPosition","position","tank","parent","getComponent","rgd","currentspeed","x","y","clone","linearVelocity","onKeyDown0","event","now","Date","landminePrefab"],"mappings":"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","sourcesContent":["import {_decorator, Component,Prefab,  systemEvent,Input,input, EventMouse,SystemEvent, Node,EventKeyboard, macro, RigidBody2D, Vec3, instantiate } from 'cc';\r\nimport { Vec2 } from 'cc';\r\nimport { enemytank } from './enemytank';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('enemyfire')\r\nexport class enemyfire extends Component {\r\n\r\n    @property\r\n    shootPower:number=500;//子弹的发射速度\r\n\r\n    @property(Prefab)\r\n    bulletPrefab:Prefab=null;\r\n\r\n    @property(Prefab)\r\n    landminePrefab:Prefab=null;\r\n\r\n    lastFireTime: number = 0; // 上次发射时间\r\n    fireInterval: number = 1; // 发射间隔时间，单位秒\r\n\r\n    landminelastFireTime: number = 0; // 上次发射时间\r\n    landminefireInterval: number = 2; // 发射间隔时间，单位秒\r\n\r\n    static fireInterval: number;\r\n\r\n    speed: Vec2 = new Vec2(0,0);\r\n    lastdirection: Vec2 = new Vec2(0,0)\r\n\r\n\r\n    update(dt) {\r\n        // 更新上次发射时间\r\n        this.lastFireTime += dt;\r\n        this.landminelastFireTime +=dt;\r\n        // 如果达到了发射间隔\r\n        if (this.lastFireTime >= this.fireInterval) {\r\n            // 调用发射子弹函数\r\n            console.log('发射子弹');\r\n            this.fireBullet();\r\n\r\n            // 重置计时\r\n            this.lastFireTime = 0;\r\n        }\r\n\r\n        if (this.landminelastFireTime >= this.landminefireInterval) {\r\n            // 调用发射子弹函数\r\n            console.log('放置地雷');\r\n            this.putlandmine();\r\n\r\n            // 重置计时\r\n            this.landminelastFireTime = 0;\r\n        }\r\n    }\r\n\r\n    private fireBullet(){\r\n        const bullet = instantiate(this.bulletPrefab);\r\n        bullet.setParent(this.node);\r\n        bullet.setPosition(this.node.position);\r\n\r\n        //console.log(this.currentiondirection);\r\n        //设置子弹实例的具体属性\r\n        const tank = this.node.parent.getComponent(enemytank);\r\n        const rgd =bullet.getComponent(RigidBody2D);\r\n        this.speed = new Vec2(tank.currentspeed.x * 400, tank.currentspeed.y * 400);\r\n\r\n        //console.log( 'this.speed ',this.speed );\r\n        if(this.speed.x!==0||this.speed.y!==0){\r\n            //console.log(\"修改\",this.speed);\r\n            this.lastdirection=this.speed;\r\n            console.log(this.lastdirection);\r\n\r\n        }\r\n        if(this.speed.x===0&&this.speed.y===0){;\r\n            this.speed=this.lastdirection.clone();\r\n        }\r\n\r\n        rgd.linearVelocity=this.speed;\r\n    }\r\n\r\n\r\n    //地雷放置模块\r\n\r\n\r\n    private onKeyDown0(event:EventKeyboard) {\r\n        const now = Date.now();\r\n        if (now - this.landminelastFireTime > this.landminefireInterval * 1000) {\r\n        this.putlandmine();\r\n        this.landminelastFireTime = now;\r\n        }\r\n    }\r\n\r\n    private putlandmine(){\r\n        console.log('放置地雷');\r\n        const bullet = instantiate(this.landminePrefab);\r\n        bullet.setParent(this.node);\r\n        bullet.setPosition(this.node.position);\r\n\r\n        //设置子弹实例的具体属性\r\n    }\r\n}\r\n"]}